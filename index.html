<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VO2Max Club de Running</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
</head>
<body class="bg-gray-100">

    <!-- Navbar -->
    <nav class="bg-white shadow-lg">
        <div class="container mx-auto px-4 py-4 flex justify-between items-center">
            <div class="flex items-center">
                <img src="img/logovo2max.png" alt="VO2Max Logo" class="h-10 object-contain">
                <span class="ml-2 text-xl font-bold text-gray-800">VO2Max Running</span>
            </div>
            <ul class="flex space-x-6">
                <li><a href="#club" class="text-gray-700 hover:text-blue-500 transition">Club</a></li>
                <li><a href="#carreras" class="text-gray-700 hover:text-blue-500 transition">Carreras</a></li>
                <li><a href="#whatsapp" class="text-gray-700 hover:text-blue-500 transition">Únete</a></li>
            </ul>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="bg-gradient-to-r from-blue-500 to-green-500 text-white py-20">
        <div class="container mx-auto text-center">
            <h1 class="text-4xl md:text-5xl font-extrabold mb-4">Bienvenido a VO2Max Running</h1>
            <p class="text-lg md:text-xl mb-8">Únete a nuestra comunidad de corredores apasionados</p>
            <a href="#carreras" class="bg-white text-blue-500 px-6 py-3 rounded-lg font-bold hover:bg-gray-100 transition">Explorar Carreras</a>
        </div>
    </section>

    <!-- Sección: Únete al Grupo de WhatsApp -->
    <section id="whatsapp" class="py-16 bg-green-50">
        <div class="container mx-auto text-center">
            <h2 class="text-3xl font-bold mb-4">Únete a Nuestro Grupo</h2>
            <p class="text-gray-700 mb-6">Mantente actualizado sobre eventos, entrenamientos y noticias</p>
            <a id="whatsapp-link" href="#" target="_blank" class="bg-green-500 text-white px-8 py-3 rounded-lg font-bold hover:bg-green-600 transition inline-flex items-center">
                <i class="fab fa-whatsapp mr-2"></i> Unirse a WhatsApp
            </a>
        </div>
    </section>

    <!-- Sección: Carreras Próximas -->
    <section id="carreras" class="py-16 bg-white">
        <div class="container mx-auto">
            <h2 class="text-3xl font-bold text-center mb-8">Próximas Carreras</h2>
            <div id="carreras-proximas" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Las carreras se cargarán dinámicamente -->
            </div>
        </div>
    </section>

    <!-- Sección: Carreras Realizadas -->
    <section class="py-16 bg-gray-50">
        <div class="container mx-auto">
            <h2 class="text-3xl font-bold text-center mb-8">Carreras Realizadas</h2>
            <div id="carreras-realizadas" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Las carreras realizadas se cargarán dinámicamente -->
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white py-8">
        <div class="container mx-auto text-center">
            <p>&copy; 2025 VO2Max Running Club. Todos los derechos reservados.</p>
        </div>
    </footer>

    <script>
        // Detectar el host dinámicamente
        const API_URL = `${window.location.protocol}//${window.location.hostname}:5000/api`;

        // Cargar información del club
        async function loadClubInfo() {
            try {
                const response = await fetch(`${API_URL}/club-info`);
                const data = await response.json();

                if (data.id) {
                    const clubInfoDiv = document.getElementById('club-info');
                    clubInfoDiv.innerHTML = `
                        <div>
                            <h3 class="text-2xl font-bold mb-4">${data.nombre}</h3>
                            <p class="text-gray-700 mb-4">${data.descripcion}</p>
                        </div>
                        <div>
                            <div class="mb-6">
                                <h4 class="text-xl font-bold mb-2">Misión</h4>
                                <p class="text-gray-700">${data.mision}</p>
                            </div>
                            <div>
                                <h4 class="text-xl font-bold mb-2">Visión</h4>
                                <p class="text-gray-700">${data.vision}</p>
                            </div>
                        </div>
                    `;
                }
            } catch (error) {
                console.error('Error cargando información del club:', error);
            }
        }

        // Cargar carreras próximas
        async function loadCarrerasProximas() {
            try {
                const response = await fetch(`${API_URL}/carreras/proximas`);
                const carreras = await response.json();

                const container = document.getElementById('carreras-proximas');
                container.innerHTML = '';

                carreras.forEach(carrera => {
                    const card = document.createElement('div');
                    card.className = 'bg-white shadow-lg rounded-lg p-6 hover:shadow-xl transition';
                    card.innerHTML = `
                        <h3 class="text-xl font-bold mb-2">${carrera.titulo}</h3>
                        <p class="text-gray-600 mb-2"><i class="fas fa-calendar"></i> ${new Date(carrera.fecha).toLocaleDateString('es-ES')}</p>
                        <p class="text-gray-600 mb-2"><i class="fas fa-map-marker-alt"></i> ${carrera.ubicacion || 'Por confirmar'}</p>
                        <p class="text-gray-600 mb-4"><i class="fas fa-tag"></i> ${carrera.categorias}</p>
                        <p class="text-gray-700 mb-4">${carrera.descripcion}</p>
                        <a href="registro.html" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 transition">Inscribirse</a>
                    `;
                    container.appendChild(card);
                });

                if (carreras.length === 0) {
                    container.innerHTML = '<p class="text-center text-gray-600">No hay carreras próximas programadas.</p>';
                }
            } catch (error) {
                console.error('Error cargando carreras próximas:', error);
            }
        }

        // Cargar carreras realizadas
        async function loadCarrerasRealizadas() {
            try {
                const response = await fetch(`${API_URL}/carreras/realizadas`);
                const carreras = await response.json();

                const container = document.getElementById('carreras-realizadas');
                container.innerHTML = '';

                carreras.forEach((carrera, index) => {
                    const card = document.createElement('div');
                    card.className = 'bg-white shadow-lg rounded-lg p-6 hover:shadow-xl transition';
                    
                    // Primera carrera (con resultados) redirige a ranking.html
                    // Otras carreras redirigen a registro.html
                    const linkHref = index === 0 ? 'ranking.html' : 'registro.html';
                    const btnText = index === 0 ? 'Ver Resultados' : 'Inscribirse';
                    const btnClass = index === 0 ? 'bg-green-500 hover:bg-green-600' : 'bg-blue-500 hover:bg-blue-600';
                    
                    card.innerHTML = `
                        <h3 class="text-xl font-bold mb-2">${carrera.titulo}</h3>
                        <p class="text-gray-600 mb-2"><i class="fas fa-calendar"></i> ${new Date(carrera.fecha).toLocaleDateString('es-ES')}</p>
                        <p class="text-gray-600 mb-2"><i class="fas fa-map-marker-alt"></i> ${carrera.ubicacion || 'Por confirmar'}</p>
                        <p class="text-gray-600 mb-4"><i class="fas fa-tag"></i> ${carrera.categorias}</p>
                        <p class="text-gray-700 mb-4">${carrera.descripcion}</p>
                        <a href="${linkHref}" class="text-white px-4 py-2 rounded transition ${btnClass}">${btnText}</a>
                    `;
                    container.appendChild(card);
                });

                if (carreras.length === 0) {
                    container.innerHTML = '<p class="text-center text-gray-600">No hay carreras realizadas aún.</p>';
                }
            } catch (error) {
                console.error('Error cargando carreras realizadas:', error);
            }
        }

        // Cargar enlace de WhatsApp
        async function loadWhatsAppLink() {
            try {
                const response = await fetch(`${API_URL}/club-info`);
                const data = await response.json();

                if (data.whatsapp_link) {
                    document.getElementById('whatsapp-link').href = data.whatsapp_link;
                }
            } catch (error) {
                console.error('Error cargando enlace de WhatsApp:', error);
            }
        }

        // Cargar todo al inicializar
        document.addEventListener('DOMContentLoaded', () => {
            loadClubInfo();
            loadCarrerasProximas();
            loadCarrerasRealizadas();
            loadWhatsAppLink();
        });
    </script>
</body>
</html>